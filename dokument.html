<!DOCTYPE html>
<html lang="sv">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Dokument – Herrgårdens Båtsällskap</title>
  <link rel="stylesheet" href="styles.css" />
  <link rel="preload" href="assets/logo.png" as="image">
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=DM+Serif+Display&family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
  <script src="config.js"></script>
  <script>
  (function(){
    var u = (typeof HBS_CONFIG !== "undefined" && HBS_CONFIG.menuScriptUrl) ? HBS_CONFIG.menuScriptUrl : "";
    if (!u) return;
    var p = (location.pathname.split("/").pop() || "index").replace(/\.html$/i, "") || "index";
    window.__hbsConfigQueue = window.__hbsConfigQueue || [];
    window.__hbsConfigCallback = function(d){ if(d) window.__hbsConfigQueue.push(d); };
    var s = document.createElement("script");
    s.src = u + "?page=" + encodeURIComponent(p) + "&callback=__hbsConfigCallback&_=" + Date.now();
    document.head.appendChild(s);
  })();
  </script>
</head>
<body>
<div id="header-placeholder">
  <header class="site-header">
    <div class="container header-inner">
      <a href="index.html" class="brand">
        <img src="assets/logo.png" class="logo" alt="Logotyp" width="120" height="50">
        <span class="brand-text">Herrgårdsvikens Båtsällskap</span>
      </a>
      <button class="hamburger" id="hamburger" aria-label="Öppna meny" aria-controls="primary-navigation" aria-expanded="false"><span></span><span></span><span></span></button>
    </div>
  </header>
  <nav id="primary-navigation" class="navigation" role="navigation" aria-label="Huvudmeny">
    <ul class="nav-list">
      <li><a href="index.html">Start</a></li>
      <li><a href="om.html">Om föreningen</a></li>
      <li><a href="medlemsinformation.html">Medlemsinformation</a></li>
      <li><a href="dokument.html">Dokument</a></li>
      <li><a href="kontakt.html">Kontakt</a></li>
    </ul>
  </nav>
</div>

<main>
  <section class="page-hero">
    <div class="container">
      <h1 data-content="heroTitle">Dokument</h1>
    </div>
  </section>

  <section class="section">
    <div class="container narrow">
      <div data-content="body">
        <h2>Dokument</h2>
        <p class="section-intro">Här nedan listas dokument från föreningens Drive-mapp. Klicka för att öppna eller ladda ner.</p>
      </div>
      <div id="document-list" class="document-list">
        <p class="document-list-loading">Laddar dokument...</p>
      </div>
    </div>
  </section>
</main>

<div id="footer-placeholder">
  <footer class="footer">
    <div class="container footer-grid">
      <div><h3>Herrgårdsvikens Båtsällskap</h3><p>En trygg och naturnära hamn på Tjurkö.</p></div>
      <div><h4>Snabblänkar</h4><ul><li><a href="om.html">Om föreningen</a></li><li><a href="medlemsinformation.html">Medlemsinformation</a></li><li><a href="dokument.html">Dokument</a></li></ul></div>
      <div><h4>Kontakt</h4><p>info@herrgardensbatsallskap.se</p><p>Tjurkö, Karlskrona</p></div>
    </div>
    <div class="footer-bottom">© 2026 Herrgårdsvikens Båtsällskap</div>
  </footer>
</div>
<script src="script.js"></script>
<script>
(function() {
  // Klistra in din Webbapp-URL här efter att du distribuerat Google Apps Script (se google-apps-script/README.md).
  var DRIVE_LIST_SCRIPT_URL = "https://script.google.com/macros/s/AKfycby_Anni2-0X2WJJzH52-SAbEIgn5pj5BWm6LBHLPA_4xho25wgJISGnHYs5cu5qQYIY/exec";

  var listEl = document.getElementById("document-list");
  if (!listEl) return;

  function renderList(files) {
    if (!files || files.length === 0) {
      listEl.innerHTML = "<p class=\"document-list-empty\">Inga dokument i mappen just nu.</p>";
      return;
    }
    var html = "<ul class=\"document-list-files\">";
    for (var i = 0; i < files.length; i++) {
      var f = files[i];
      var name = (f.name || "Dokument").replace(/</g, "&lt;").replace(/>/g, "&gt;").replace(/"/g, "&quot;");
      var url = (f.url || "#").replace(/"/g, "&quot;");
      html += "<li><a href=\"" + url + "\" target=\"_blank\" rel=\"noopener noreferrer\">" + name + "</a></li>";
    }
    html += "</ul>";
    listEl.innerHTML = html;
  }

  function showError() {
    listEl.innerHTML = "<p class=\"document-list-error\">Kunde inte ladda dokument. Kontrollera att Webbapp-URL är ifylld i dokument.html (se google-apps-script/README.md).</p>";
  }

  if (!DRIVE_LIST_SCRIPT_URL || DRIVE_LIST_SCRIPT_URL.indexOf("script.google.com") === -1) {
    showError();
    return;
  }

  window.__driveListCallback = function(data) {
    window.__driveListCallback = null;
    if (Array.isArray(data)) {
      renderList(data);
    } else {
      showError();
    }
  };

  var script = document.createElement("script");
  script.src = DRIVE_LIST_SCRIPT_URL + (DRIVE_LIST_SCRIPT_URL.indexOf("?") >= 0 ? "&" : "?") + "callback=__driveListCallback";
  script.async = true;
  script.onerror = function() {
    showError();
  };
  document.head.appendChild(script);
})();
</script>
<script>
(function(){
  var password = "hamn2024";
  var ok = sessionStorage.getItem("docAuth") === "1";
  if (!ok) {
    var input = prompt("Ange lösenord för att visa dokument:");
    if (input === password) {
      sessionStorage.setItem("docAuth", "1");
    } else {
      document.body.innerHTML = "<h1 style='padding:100px;text-align:center;'>Fel lösenord</h1>";
      return;
    }
  }
})();
</script>
</body>
</html>
